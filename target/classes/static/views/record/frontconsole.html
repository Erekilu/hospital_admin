<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layuiAdmin 控制台主页一</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/admin.css" media="all">
</head>
<body>

<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md8">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md6">
                    <div class="layui-card">
                        <div class="layui-card-header">快捷方式</div>
                        <div class="layui-card-body">

                            <div class="layui-carousel layadmin-carousel layadmin-shortcut">
                                <div carousel-item>
                                    <ul class="layui-row layui-col-space10">
                                        <li class="layui-col-xs3">
                                            <a lay-href="/views/assign/patientoperation.html">
                                                <i class="layui-icon layui-icon-chart"></i>
                                                <cite>患者管理</cite>
                                            </a>
                                        </li>
                                        <li class="layui-col-xs3">
                                            <a lay-href="/views/userinfo.html">
                                                <i class="layui-icon layui-icon-user"></i>
                                                <cite>用户信息</cite>
                                            </a>
                                        </li>
                                        <li class="layui-col-xs3">
                                            <a lay-href="/views/message.html">
                                                <i class="layui-icon layui-icon-survey"></i>
                                                <cite>日志记录</cite>
                                            </a>
                                        </li>
                                        <li class="layui-col-xs3">
                                            <a lay-href="/views/assign/statistical.html">
                                                <i class="layui-icon layui-icon-template-1"></i>
                                                <cite>数据总览</cite>
                                            </a>
                                        </li>
                                    </ul>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="layui-col-md6">
                    <div class="layui-card">
                        <div class="layui-card-header">待办事项</div>
                        <div class="layui-card-body">

                            <div class="layui-carousel layadmin-carousel layadmin-backlog">
                                <div carousel-item>
                                    <ul class="layui-row layui-col-space10">
                                        <li class="layui-col-xs6">
                                            <a lay-href="app/content/comment.html" class="layadmin-backlog-body">
                                                <h3>今日录入病人数</h3>
                                                <p><cite id="allPatientToday">14</cite></p>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-header">今日数据概览</div>
                        <div class="layui-card-body">
                            <div id="chart2" style="height:400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-col-md4">

            <div class="layui-card">
                <div class="layui-card-header">性别比例</div>
                <div class="layui-card-body layadmin-takerates">
                    <div class="layui-progress" lay-showPercent="true" lay-filter="xxx">
                        <h3>今日录入病人男女比</h3>
                        <div id="yyy" class="layui-progress-bar" lay-percent="0%"></div>
                    </div>
                </div>
            </div>

            <div class="layui-card">
                <div class="layui-card-header">凑数图</div>
                <div class="layui-card-body layadmin-takerates">
                    <div id="chart1" style="height:400px;"></div>
                </div>
            </div>

        </div>

    </div>
</div>

<script src="/layuiadmin/layui/layui.js?t=1"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
<script src="/layuiadmin/frontindex.js"></script>
<script>
    layui.config({
        base: '/layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'console', 'element'], function() {
        let $ = layui.$,
            element = layui.element;
        let statistical;

        $.ajax({
            url: '/getData1',
            method: 'GET',
            async: false,
            success: function(res) {
                statistical = res;
            }
        });

        $('#yyy').attr('lay-percent', statistical.man * 1.0 / (statistical.woman + statistical.man) * 100 + '%');
        $('#allPatientToday').text(statistical.man + statistical.woman);

        let myChart1 = echarts.init(document.getElementById('chart1'));
        let myChart2 = echarts.init(document.getElementById('chart2'));

        let option1 = {
            legend: {
                orient: 'vertical',
                left: 'left',
                data: ['男', '女']
            },
            title: {
                text: '今日录入男女比例',
                left: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b} : {c} ({d}%)'
            },
            series: [
                {
                    name: '病人数目',
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '55%'],
                    color: ['#1E9FFF', '#5FB878'],
                    data: [
                        {value: statistical.man, name: '男'},
                        {value: statistical.woman, name: '女'}

                    ],
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        let option2 = {
            grid: {
                left: '15%',
                right: '15%'
            },
            title: {
                text: '今日不同时段录入的病人数',
                subtext: '数据仅供参考',
                left: 'center'
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            dataZoom: [
                {   // 这个dataZoom组件，默认控制x轴。
                    type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
                    start: 0,      // 左边在 10% 的位置。
                    end: 30        // 右边在 60% 的位置。
                },
                {   // 这个dataZoom组件，也控制x轴。
                    type: 'inside', // 这个 dataZoom 组件是 inside 型 dataZoom 组件
                    start: 0,      // 左边在 10% 的位置。
                    end: 30         // 右边在 60% 的位置。
                }
            ],
            xAxis: [
                {
                    type: 'category',
                    data: ['红蓝', '死灵', '黑巨', '白红', '咆哮绿', '黑白系命', '三色混', '法伤', '神器', '三色化灵', '绿蓝化灵', '其他'],
                    axisTick: {
                        alignWithLabel: true
                    }
                }
            ],
            yAxis: [
                {
                    name: '使用次数(周)',
                    type: 'value'
                },
                {
                    name: '平均胜率(%)',
                    type: 'value',
                    max: 100,
                    axisLabel: {
                        show: true,
                        interval: 'auto',//居中显示
                        formatter: '{value} %'//以百分比显示
                    },
                }

            ],
            series: [
                {
                    name: '使用次数',
                    type: 'line',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#83bff6'},
                                {offset: 0.5, color: '#188df0'},
                                {offset: 1, color: '#188df0'}
                            ]
                        )
                    },
                    barWidth: '50%',
                    data: [4032, 5441, 4121, 2020, 2155, 2858, 2585, 1874, 3120, 1992, 1859, 4212]
                },
                {
                    name: '平均胜率',
                    type: 'line',
                    yAxisIndex: 1,
                    tooltip: {
                        trigger: 'axis',
                        formatter: '{c}%'
                    },
                    data: [53, 61, 57, 51, 52, 54, 52, 54, 51, 51, 52, 46]
                }
            ]
        };


        myChart1.setOption(option1);
        myChart2.setOption(option2);
    });
</script>
</body>
</html>

